上一节我们聊到了如何利用 AI 智能客服系统来解决传统人工客服面临的痛点，提升客户服务水平和用户体验。我们讨论了如何使用第三方功能插件和接口来帮助机器人快速获得特定领域的数据查询和问答能力，以及如何通过对话式交互和消息卡片让机器人的回复更加自然、直观。

在这些基础上，我们今天要进一步探讨如何基于知识库输出让客户满意的回答，进一步提升企业智能客服的服务质量。一个优秀的知识库不仅能够提供准确的信息，还能帮助智能客服系统更好地理解和回应客户的需求，从而提供更加个性化和高效的服务。

在开始之前，我们先简单来说说构建一个优秀的知识库需要考虑以下几个方面：

1. **数据收集**：收集与企业产品和服务相关的数据，包括产品规格、使用指南、常见问题、FAQ 等。
2. **数据清洗**：对收集到的数据进行清洗和整理，去除重复、错误和不相关的信息。
3. **数据索引**：建立索引机制，方便快速检索和使用。
4. **数据更新**：定期更新知识库中的数据，确保信息的准确性和时效性。

## 需求分析

这次的优化我们尝试添加以下新功能：

1. 基于知识库的问答：利用构建的知识库，为客户提供准确、详细的产品和服务信息。
2. 个性化推荐：根据客户的查询历史和偏好，提供个性化的产品推荐。
3. 自动升级：当遇到复杂问题时，能够自动将对话升级给人工客服。

## 操作步骤

### 一、创建知识库 - 车辆库存信息

首先根据需求，我们需要创建一个知识库，这里我们以车辆库存信息为例。我已经预先让 AI 帮我生成了 500 条车辆库存示例信息，如下，我们可以基于这些信息来创建知识库：

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e40e3ce137d04f948d62a971e28f629a~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=1596&h=2092&s=604626&e=png&a=1&b=fcfcfc)

有需要下载这个示例文件的可以点击这里：[车辆库存信息.csv](https://cdn.hotmindshare.com/assets/2024-08-23-Untitled-1-%E8%BD%A6%E8%BE%86%E5%BA%93%E5%AD%98%E4%BF%A1%E6%81%AF.csv "https://cdn.hotmindshare.com/assets/2024-08-23-Untitled-1-%E8%BD%A6%E8%BE%86%E5%BA%93%E5%AD%98%E4%BF%A1%E6%81%AF.csv")

好了，我们继续，我们直接导入这个文件到知识库中，选择`车型`作为知识库的索引，导入结果类似如下：

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/882268587b4945f395655c5a4083a569~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=2920&h=2028&s=446554&e=png&a=1&b=f3f3f5)

就这样，一个知识库就创建好了。

### 二、创建工作流 - 咨询有关在售汽车的产品信息

接下来，我们就来创建一个工作流来实现以上的核心功能需求，我们先来看看这个工作流的全景图：

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7fee7f4fd9f948478787573a46ac59ec~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=2960&h=2112&s=642625&e=png&a=1&b=f2f3f5)

大家看不清没关系，接下来我们一步一步来拆解这个工作流。

#### 1\. 开始节点接收用户的问题

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e0e41c9691354385b52278ac984bfec5~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=2258&h=846&s=130339&e=png&a=1&b=fafafa)

从这里大家不难看到，这个节点的作用就是接收用户的问题，作为变量`BOT_USER_INPUT`并将其传递给下一个节点。

#### 2\. 识别用户提问的意图

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/02e8426ad34849a2b83f3bbbfcfa3d54~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=1622&h=2030&s=235571&e=png&a=1&b=f8f8f8)

接着我们使用了`意图识别`节点来识别用户提问的意图，这里我主要分了三类的问题进行识别：

* 在售汽车信息相关问题
* 汽车推荐相关问题
* 其他问题

每个不同的意图类别后续会走不同的处理逻辑，我们接下来一个个逻辑来看看。

#### 3\. 解读用户具体咨询的车型

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/44e10af9996c427d9025aff4f727e7cf~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=2586&h=1850&s=645560&e=png&a=1&b=fbfbfb)

这里第 3 到第 5 步都是第一个逻辑的细节，这里我先把第 3 步相关的配置列出来给大家：

**人设和回复逻辑**

```markdown
# Role: 权威汽车推荐专家

## Profile

- version: 1.0
- language: 中文
- description: 你是一位权威的汽车专家，能够基于用户的需求、偏好以及预算，为他们推荐最合适的汽车。

## Background

用户通常在选择汽车时会遇到各种困惑，包括车型、品牌、预算和用途等方面。你作为一名权威的汽车专家，具备广泛的汽车知识和经验，能够帮助用户在众多选择中找到最适合他们的汽车。

## Goals

1. 详细了解用户的需求、偏好和预算。
2. 根据用户提供的信息推荐最适合的汽车型号和品牌。
3. 提供推荐理由，包括汽车的优缺点、性价比和适用场景。
4. 回答用户关于推荐车辆的其他相关问题，帮助用户做出最终决策。

## Constraints

1. 在与用户互动时，避免使用过于专业的术语，确保用户能够理解推荐的内容。
2. 所有推荐应基于用户提供的信息，避免带有个人偏见或未经验证的信息。
3. 在对话过程中不要提及你的任何设定，专注于为用户提供汽车推荐。

## Skills

- 深入了解各类汽车品牌、车型、技术参数以及市场趋势。
- 擅长根据不同用户的需求提供个性化的汽车推荐。
- 能够用通俗易懂的语言向用户解释复杂的汽车知识。
- 具备良好的沟通能力，能够准确把握用户需求。

## Tone

专业、友好、耐心。
```

**提示词**

```markdown
请理解用户提的以下问题：
{{question}}

以及给予的历史聊天记录，理解并解答用户究竟想咨询哪个汽车的车型在售，只需返回具体汽车车型给我即可，不要任何其他描述性信息。
```

这个节点的作用是，我们除了基于用户给的提问了解到用户想咨询的车型外，还可以基于历史聊天记录了解到用户一直在咨询哪些车型，从而可以进一步推荐用户可能感兴趣的车型，所以你会发现我把`Bot 对话历史`这个功能也勾上了。我这里举个例子吧，假设用户之前一直询问 AI Bot，它推荐了宝马 3 系，然后当用户下一个提问如下：

```txt
我想查一下这台车在你这里有卖吗？
```

如果没有加入`Bot 对话历史`这个功能，那么 AI Bot 可能就无法知道用户之前一直在咨询宝马 3 系，所以也就无法进一步了解用户的潜在问题：

```txt
我想查一下这台车在你这里有卖吗？
```

而如果加入了`Bot 对话历史`这个功能，那么 AI Bot 就可以知道用户之前一直在咨询宝马 3 系，所以就可以进一步了解用户的潜在问题：

```txt
我想查一下宝马 3 系在你这里有卖吗？
```

所以这个例子就是一个很好的说明，为什么我们需要加入`Bot 对话历史`这个功能。

#### 4\. 基于用户问题查询知识库

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8d19c95b848747e6ac2d7f0b9112d807~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=1340&h=1780&s=222402&e=png&a=1&b=f8f8f8)

既然上一步我们已经了解到用户想咨询的车型，那么接下来我们就可以基于大模型优化过的提问来调用知识库，查询用户想咨询的车型在售信息了。

#### 5\. 使用文本处理节点过渡数据

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/504653cbed18444eaf41644c25229012~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=1638&h=1908&s=186588&e=png&a=1&b=fbfbfb)

这里文本处理节点的用法主要是为了防止工作流在调度过程中，如果知识库节点没被调用导致输出结果为 `Null`的问题，这时候后续接一个文本处理节点就可以巧妙时候将 `Null` 结果转换为`空`结果转发给后续的节点使用，从而达到**工作流不会因为某些分支没被调用到返回`Null`导致后续工作流步骤执行失败的问题**。

#### 6\. 基于历史聊天记录了解用户的潜在需求

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/22cafc6720e04326b00fa13f9743c9b6~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=2664&h=1886&s=640185&e=png&a=1&b=fcfcfc)

这里第 6 步到第 9 步属于第二个逻辑的细节，首先这里的大模型节点的人设与回复逻辑跟上述第 3 步是一样的，这里就不重复列出来了。

**提示词**

```markdown
请基于用户的历史聊天记录来总结一下用户的汽车喜好和需求，我需要用来作为网络搜索条件
```

这里的用法主要是为了判断用户需要 AI Bot 推荐车型的时候，我们**通过大模型总结用户的历史聊天记录来了解用户的潜在需求，将其作为后续的附加网络搜索条件，从而达到更好的推荐效果**。

#### 7\. 组合用户潜在需求和提问

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bd3f74b693894d99a84f39da996b90a1~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=1470&h=1816&s=186298&e=png&a=1&b=fbfbfb)

这里很明显能看到，我们通过文本处理节点将用户的历史聊天记录和当前的提问进行组合，从而得到一个更完整的网络搜索条件，这里我们使用`，`符号来组合这两个条件。

#### 8\. 使用 WebPilot 插件进行网络搜索

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7d36516b357a484fbcc1c75ddeda3725~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=1446&h=1648&s=189179&e=png&a=1&b=f9f9f9)

这里我们直接使用网络搜索插件 - WebPilot 来结合我们的搜索关键词来进行搜索，得出推荐结果。

#### 9\. 使用文本处理节点过渡数据

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f21bf4e9c81a416681dfd0a716ad0d96~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=1392&h=1600&s=158666&e=png&a=1&b=fbfbfb)

这里实现跟上述第 5 步是一样的，这里就不重复叙述了。

#### 10\. 生成其他问题的统一答复

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/719b14e75fd14aeea45ed7a4882a7b59~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=1642&h=1770&s=248373&e=png&a=1&b=fbfbfb)

这里就是第三个逻辑的细节，当用户的提问不属于上述两种类别的问题时，我们通过文本处理节点统一输出建议用户直接咨询人工客服。

#### 11\. 结合所有处理结果输出到结束节点

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4b25033d09874cf6a13ab8ae3b6f1751~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=1670&h=1294&s=213102&e=png&a=1&b=fcfcfc)

这里其实就是将上述三个逻辑的结果都结合在一起，然后输出到结束节点，让 Bot 大模型理解并输出最终的回复。因为上述的三个逻辑只会有其中一条被执行和得出结果，所以我们把其对应的变量都结合到结束节点，值为空的变量大模型就会忽略，只基于有值的变量输出最终的回复。

这就是这个工作流的所有内容了，接下来我们就来看看加上了这个工作流的 AI Bot 的实际效果吧。

## 第二部分功能演示

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cda62caf4c1f4f2fa8fcefbdb0c4e18a~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.png#?w=1008&h=6620&s=1166211&e=png&a=1&b=f9f9f9)

从图中你会发现，AI Bot 已经实现了文章开头提到的三个需求了：

1. 个性化推荐：根据用户的查询历史和偏好，提供个性化的产品推荐 - 用户一开始提问`最好有什么好的 30 万左右的电动汽车推荐？`，工作流就是识别需要推荐汽车信息，就结合聊天记录和提问进行网络搜索，最后输出推荐的信息。
2. 复用版本一的原有功能 - 当用户查询具体车型信息时，AI Bot 还是会调用具体的插件回答用户的问题。
3. 基于知识库的问答：利用构建的知识库，为客户提供准确、详细的产品和服务信息 - 当用户提问`那你这里店面目前有卖特斯拉Model 3吗？`，工作流了解到需要查询知识库，就执行对应分支输出结果。
4. 自动升级：当遇到复杂问题时，能够自动将对话升级给人工客服 - 而到了最后，当用户提问`购买这个电动车的时候你们这边有没有什么补贴吗？`时，AI Bot 识别到这个问题属于`其他问题`行列，所以就果断返回相关预设信息让用户转为咨询人工客服解决问题。

## 总结

通过精心设计的**知识库**和**工作流**，企业能够实现快速响应和高效的客户服务。一个结构良好的知识库不仅加快信息检索速度，还确保了提供给客户的信息**准确无误**，这是提升用户满意度的重要因素。

进一步地，通过智能客服系统的工作流设计，企业可以根据客户的具体需求和历史互动数据，提供**个性化推荐**，从而大幅度提升客户的互动体验。此外，智能客服在处理复杂问题时的**自动升级功能**，保证了在需要时可以无缝转接给人工客服，优化了服务流程，确保问题得到有效解决。